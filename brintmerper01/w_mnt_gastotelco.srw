HA$PBExportHeader$w_mnt_gastotelco.srw
forward
global type w_mnt_gastotelco from w_md_std
end type
type tab_1 from tab within tp1
end type
type tabpage_1 from userobject within tab_1
end type
type cb_29 from commandbutton within tabpage_1
end type
type dw_2 from uo_dw_std within tabpage_1
end type
type cb_1 from commandbutton within tabpage_1
end type
type dw_1 from uo_dw_std within tabpage_1
end type
type cb_5 from commandbutton within tabpage_1
end type
type tabpage_1 from userobject within tab_1
cb_29 cb_29
dw_2 dw_2
cb_1 cb_1
dw_1 dw_1
cb_5 cb_5
end type
type tabpage_7 from userobject within tab_1
end type
type cb_30 from commandbutton within tabpage_7
end type
type dw_8 from uo_dw_std within tabpage_7
end type
type cb_8 from commandbutton within tabpage_7
end type
type cb_15 from commandbutton within tabpage_7
end type
type tabpage_7 from userobject within tab_1
cb_30 cb_30
dw_8 dw_8
cb_8 cb_8
cb_15 cb_15
end type
type tabpage_2 from userobject within tab_1
end type
type cb_31 from commandbutton within tabpage_2
end type
type dw_3 from uo_dw_std within tabpage_2
end type
type cb_2 from commandbutton within tabpage_2
end type
type cb_16 from commandbutton within tabpage_2
end type
type tabpage_2 from userobject within tab_1
cb_31 cb_31
dw_3 dw_3
cb_2 cb_2
cb_16 cb_16
end type
type tabpage_12 from userobject within tab_1
end type
type cb_32 from commandbutton within tabpage_12
end type
type cb_13 from commandbutton within tabpage_12
end type
type dw_13 from uo_dw_std within tabpage_12
end type
type cb_17 from commandbutton within tabpage_12
end type
type tabpage_12 from userobject within tab_1
cb_32 cb_32
cb_13 cb_13
dw_13 dw_13
cb_17 cb_17
end type
type tabpage_3 from userobject within tab_1
end type
type cb_33 from commandbutton within tabpage_3
end type
type dw_4 from uo_dw_std within tabpage_3
end type
type cb_3 from commandbutton within tabpage_3
end type
type cb_18 from commandbutton within tabpage_3
end type
type tabpage_3 from userobject within tab_1
cb_33 cb_33
dw_4 dw_4
cb_3 cb_3
cb_18 cb_18
end type
type tabpage_5 from userobject within tab_1
end type
type cb_34 from commandbutton within tabpage_5
end type
type dw_6 from uo_dw_std within tabpage_5
end type
type cb_6 from commandbutton within tabpage_5
end type
type cb_19 from commandbutton within tabpage_5
end type
type tabpage_5 from userobject within tab_1
cb_34 cb_34
dw_6 dw_6
cb_6 cb_6
cb_19 cb_19
end type
type tabpage_10 from userobject within tab_1
end type
type cb_35 from commandbutton within tabpage_10
end type
type cb_11 from commandbutton within tabpage_10
end type
type dw_11 from uo_dw_std within tabpage_10
end type
type cb_20 from commandbutton within tabpage_10
end type
type tabpage_10 from userobject within tab_1
cb_35 cb_35
cb_11 cb_11
dw_11 dw_11
cb_20 cb_20
end type
type tabpage_11 from userobject within tab_1
end type
type cb_36 from commandbutton within tabpage_11
end type
type dw_12 from uo_dw_std within tabpage_11
end type
type cb_12 from commandbutton within tabpage_11
end type
type cb_21 from commandbutton within tabpage_11
end type
type tabpage_11 from userobject within tab_1
cb_36 cb_36
dw_12 dw_12
cb_12 cb_12
cb_21 cb_21
end type
type tabpage_4 from userobject within tab_1
end type
type cb_37 from commandbutton within tabpage_4
end type
type dw_5 from uo_dw_std within tabpage_4
end type
type cb_4 from commandbutton within tabpage_4
end type
type cb_22 from commandbutton within tabpage_4
end type
type tabpage_4 from userobject within tab_1
cb_37 cb_37
dw_5 dw_5
cb_4 cb_4
cb_22 cb_22
end type
type tabpage_14 from userobject within tab_1
end type
type cb_38 from commandbutton within tabpage_14
end type
type cb_27 from commandbutton within tabpage_14
end type
type cb_28 from commandbutton within tabpage_14
end type
type dw_15 from uo_dw_std within tabpage_14
end type
type tabpage_14 from userobject within tab_1
cb_38 cb_38
cb_27 cb_27
cb_28 cb_28
dw_15 dw_15
end type
type tabpage_8 from userobject within tab_1
end type
type cb_39 from commandbutton within tabpage_8
end type
type cb_9 from commandbutton within tabpage_8
end type
type dw_9 from uo_dw_std within tabpage_8
end type
type cb_23 from commandbutton within tabpage_8
end type
type tabpage_8 from userobject within tab_1
cb_39 cb_39
cb_9 cb_9
dw_9 dw_9
cb_23 cb_23
end type
type tabpage_9 from userobject within tab_1
end type
type cb_40 from commandbutton within tabpage_9
end type
type cb_10 from commandbutton within tabpage_9
end type
type dw_10 from uo_dw_std within tabpage_9
end type
type cb_24 from commandbutton within tabpage_9
end type
type tabpage_9 from userobject within tab_1
cb_40 cb_40
cb_10 cb_10
dw_10 dw_10
cb_24 cb_24
end type
type tabpage_6 from userobject within tab_1
end type
type cb_41 from commandbutton within tabpage_6
end type
type dw_7 from uo_dw_std within tabpage_6
end type
type cb_7 from commandbutton within tabpage_6
end type
type cb_25 from commandbutton within tabpage_6
end type
type tabpage_6 from userobject within tab_1
cb_41 cb_41
dw_7 dw_7
cb_7 cb_7
cb_25 cb_25
end type
type tabpage_13 from userobject within tab_1
end type
type cb_42 from commandbutton within tabpage_13
end type
type cb_14 from commandbutton within tabpage_13
end type
type dw_14 from uo_dw_std within tabpage_13
end type
type cb_26 from commandbutton within tabpage_13
end type
type tabpage_13 from userobject within tab_1
cb_42 cb_42
cb_14 cb_14
dw_14 dw_14
cb_26 cb_26
end type
type tabpage_15 from userobject within tab_1
end type
type dw_17 from uo_dw_std within tabpage_15
end type
type cb_45 from commandbutton within tabpage_15
end type
type cb_44 from commandbutton within tabpage_15
end type
type cb_46 from commandbutton within tabpage_15
end type
type tabpage_15 from userobject within tab_1
dw_17 dw_17
cb_45 cb_45
cb_44 cb_44
cb_46 cb_46
end type
type tab_1 from tab within tp1
tabpage_1 tabpage_1
tabpage_7 tabpage_7
tabpage_2 tabpage_2
tabpage_12 tabpage_12
tabpage_3 tabpage_3
tabpage_5 tabpage_5
tabpage_10 tabpage_10
tabpage_11 tabpage_11
tabpage_4 tabpage_4
tabpage_14 tabpage_14
tabpage_8 tabpage_8
tabpage_9 tabpage_9
tabpage_6 tabpage_6
tabpage_13 tabpage_13
tabpage_15 tabpage_15
end type
type tp15 from userobject within td
end type
type dw_16 from uo_dw_std within tp15
end type
type ddlb_1 from dropdownlistbox within tp15
end type
type ddlb_2 from dropdownlistbox within tp15
end type
type cb_43 from commandbutton within tp15
end type
type tp15 from userobject within td
dw_16 dw_16
ddlb_1 ddlb_1
ddlb_2 ddlb_2
cb_43 cb_43
end type
end forward

global type w_mnt_gastotelco from w_md_std
integer width = 3881
integer height = 2364
boolean maxbox = false
end type
global w_mnt_gastotelco w_mnt_gastotelco

type variables
long il_idsol = 0
string is_codcli = ""
string is_nomcli = ""
integer ii_mes, ii_anno
end variables

on w_mnt_gastotelco.create
int iCurrent
call super::create
end on

on w_mnt_gastotelco.destroy
call super::destroy
if IsValid(MenuID) then destroy(MenuID)
end on

event ue_menu_grabar;string ls_codcli, ls_codect, ls_observacion
setnull(ls_codcli)
setnull(ls_codect)
setnull(ls_observacion)

ls_codcli	=	dw_maestro.getitemstring(dw_maestro.getrow(),'codcli')
// se guarda nombre por contacto empleado
// is_nomcli
//ls_codect =   dw_maestro.getitemstring(dw_maestro.getrow(),'codect')
//ls_observacion = dw_maestro.getitemstring(dw_maestro.getrow(),'observacion')

if isnull(ls_codcli) Then 
	messagebox("Informacion", "Cod de cliente no especificado")
	return  
end if	

CALL SUPER::ue_menu_grabar
// se recupera la informacion de los hijos
td.tp1.dw1.retrieve(il_idsol, '01')
//td.tp2.dw2.retrieve(il_idsol, '02')
//td.tp3.dw3.retrieve(il_idsol, '03')
//td.tp4.dw4.retrieve(il_idsol, '04')
//td.tp5.dw5.retrieve(il_idsol, '05')
//td.tp6.dw6.retrieve(il_idsol, '06')
////td.tp7.dw7.retrieve(is_codcli)
//td.tp8.dw8.retrieve(is_codcli)
//td.tp9.dw9.retrieve(is_codcli)
end event

event ue_menu_nuevo;call super::ue_menu_nuevo;il_idsol = 0
is_codcli = ""
is_nomcli = ""

// se blanquea a los datawindows
td.tp1.dw1.triggerevent("ue_ini_dw")
end event

event ue_postopen;integer li_fecha
dw_maestro.setfocus()
m_mnt_std lmenu1
lmenu1 = this.menuid
lmenu1.uf_set_dw(dw_maestro)
dw_maestro.trigger event ue_ini_dw()
is_codcli = ist_par.parstring1
il_idsol = ist_par.parlong1

if ist_par.parinteger1 = 1 then
	td.tp1.tab_1.tabpage_1.visible = false
	td.tp1.tab_1.tabpage_2.visible = false
	td.tp1.tab_1.tabpage_3.visible = false
	td.tp1.tab_1.tabpage_4.visible = false
	td.tp1.tab_1.tabpage_5.visible = false
	td.tp1.tab_1.tabpage_6.visible = false
	td.tp1.tab_1.tabpage_7.visible = false
	td.tp1.tab_1.tabpage_8.visible = false
	td.tp1.tab_1.tabpage_9.visible = false
	td.tp1.tab_1.tabpage_10.visible = false
	td.tp1.tab_1.tabpage_11.visible = false
	td.tp1.tab_1.tabpage_12.visible = false
	td.tp1.tab_1.tabpage_13.visible = false
	td.tp1.tab_1.tabpage_14.visible = false
	td.tp1.tab_1.tabpage_15.visible = true
	td.tp1.tab_1.SelectTab(td.tp1.tab_1.tabpage_15)
	td.tp15.visible = false	

else 
	td.tp1.tab_1.tabpage_15.visible = false
end if



if ii_tipo = 1 then
	dw_maestro.trigger event ue_insertar()
	//dw_maestro.setitem(1,'idestado','00')
	this.post event ue_permisos()
	this.post event ue_permisos_menu()
	
	if gsPais = 'PER' then
		dw_maestro.setitem(1,"codcli",ist_par.parstring1)
		dw_maestro.SetItem(1,'nomcli',ist_par.parstring2)
	end if
else
	this.post event ue_cargar()
//	this.post event ue_permisos()
//	this.post event ue_permisos_menu()
	CHOOSE CASE ii_tipo
		CASE 2,4	//Aprobar y Mantener
			if ist_par.parstring3 = '01' then 
				dw_maestro.SetTabOrder("idestado",1)
				dw_maestro.object.cb_completo.visible = false
		   end if
		CASE 3
			dw_maestro.enabled=false
			td.tp1.dw1.enabled=false
//			td.tp2.dw2.enabled=false
//			td.tp3.dw3.enabled=false
//			td.tp4.dw4.enabled=false
//			td.tp5.dw5.enabled=false
//			td.tp6.dw6.enabled=false
//			//td.tp7.dw7.enabled=false
//			td.tp8.dw8.enabled=false
//			td.tp9.dw9.enabled=false
        
	END CHOOSE
end if   

li_fecha = year(today())
td.tp15.ddlb_1.Additem(string(li_fecha - 1))
td.tp15.ddlb_1.Additem(string(li_fecha))
td.tp15.ddlb_1.Additem(string(li_fecha + 1) )




end event

event resize;call super::resize;td.tp1.tab_1.height = td.height -100
td.tp1.tab_1.tabpage_1.dw_2.height = td.height - 400
td.tp1.tab_1.tabpage_2.dw_3.height = td.height -200
td.tp1.tab_1.tabpage_3.dw_4.height = td.height -200
td.tp1.tab_1.tabpage_4.dw_5.height = td.height -200
td.tp1.tab_1.tabpage_5.dw_6.height = td.height -200
td.tp1.tab_1.tabpage_6.dw_7.height = td.height -200
td.tp1.tab_1.tabpage_7.dw_8.height = td.height -200
td.tp1.tab_1.tabpage_8.dw_9.height = td.height -200
td.tp1.tab_1.tabpage_9.dw_10.height = td.height -200
td.tp1.tab_1.tabpage_10.dw_11.height = td.height -200
td.tp1.tab_1.tabpage_11.dw_12.height = td.height -200
td.tp1.tab_1.tabpage_12.dw_13.height = td.height -200
td.tp1.tab_1.tabpage_13.dw_14.height = td.height -200
td.tp1.tab_1.tabpage_14.dw_15.height = td.height -200
td.tp1.tab_1.tabpage_15.dw_17.height = td.height -350

td.tp1.tab_1.width = td.width -100
td.tp1.tab_1.tabpage_1.dw_2.width = td.width - 300
td.tp1.tab_1.tabpage_2.dw_3.width = td.width -200
td.tp1.tab_1.tabpage_3.dw_4.width = td.width -200
td.tp1.tab_1.tabpage_4.dw_5.width = td.width -200
td.tp1.tab_1.tabpage_5.dw_6.width = td.width -200
td.tp1.tab_1.tabpage_6.dw_7.width = td.width -200
td.tp1.tab_1.tabpage_7.dw_8.width = td.width -200
td.tp1.tab_1.tabpage_8.dw_9.width = td.width -200
td.tp1.tab_1.tabpage_9.dw_10.width = td.width -200
td.tp1.tab_1.tabpage_10.dw_11.width = td.width -200
td.tp1.tab_1.tabpage_11.dw_12.width = td.width -200
td.tp1.tab_1.tabpage_12.dw_13.width = td.width -200
td.tp1.tab_1.tabpage_13.dw_14.width = td.width -200
td.tp1.tab_1.tabpage_14.dw_15.width = td.width -200
td.tp1.tab_1.tabpage_15.dw_17.width = td.width -200
end event

event open;call super::open;dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_1.dw_2)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_7.dw_8)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_2.dw_3)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_12.dw_13)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_3.dw_4)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_5.dw_6)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_10.dw_11)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_11.dw_12)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_4.dw_5)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_14.dw_15)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_8.dw_9)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_9.dw_10)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_6.dw_7)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_13.dw_14)
dw_maestro.uf_set_hijo(td.tp1.tab_1.tabpage_15.dw_17)
end event

type dw_maestro from w_md_std`dw_maestro within w_mnt_gastotelco
integer x = 46
integer y = 28
integer width = 3058
integer height = 780
integer taborder = 10
string dataobject = "d_mnt_gastotelco"
boolean hscrollbar = false
boolean vscrollbar = false
boolean border = false
boolean hsplitscroll = false
boolean livescroll = false
boolean borrar = false
boolean seleccionar = false
end type

event dw_maestro::ue_valida_dato;call super::ue_valida_dato;string ls_codect
st_par lst_par_in

choose case as_columna
	case 'codcli'
		openwithparm(w_lov_gastotelco, lst_par_in)
		lst_par_in = message.powerobjectparm
		if isvalid(lst_par_in) then
			// se inserta el codigo del cliente
			IF LEN(TRIM(lst_par_in.parstring1)) <> 0 THEN			
				is_codcli = lst_par_in.parstring1
				is_nomcli = lst_par_in.parstring2
				this.setitem(al_row,'codcli',lst_par_in.parstring1)
				this.setitem(al_row,'nomcli',lst_par_in.parstring2)
				select codect into :ls_codect from vtatabcli where codcli = :lst_par_in.parstring1;
				this.setitem(al_row,'codect', ls_codect)
			END IF		
		END IF
end choose
return 0
end event

event dw_maestro::ue_retrieve;retrieve(il_idsol)
return 0
end event

event dw_maestro::ue_update_post;call super::ue_update_post;long ll_valor   
string ls_key    
if getrow() < 1 then return false
if IsNull(object.idsol[getrow()]) /*or object.idficha[getrow()] = ''*/ then
	SELECT MAX((idsol))	
  	INTO :ll_valor
  	FROM SOL_GASTOS_TELCOM;
	if SQLCA.SQLCode < 0 then
		MessageBox(title, error_guardar)
		return false
	end if 
	il_idsol = ll_valor
	object.idsol[1] = il_idsol
	AcceptText()
end if

// se hace el retrieve de la cabecera
triggerevent('ue_retrieve')

// td.tp7.dw7.retrieve(is_codcli)
// td.tp8.dw8.retrieve(is_codcli)

return true
end event

event dw_maestro::ue_valores_iniciales;call super::ue_valores_iniciales;dw_maestro.setitem(al_row,'idestado','00')

if ist_par.parinteger1 = 1 then 
   dw_maestro.setitem(al_row,'tipgp',2)
else
   dw_maestro.setitem(al_row,'tipgp',1)
end if
end event

event dw_maestro::ue_update_pre_row;call super::ue_update_pre_row;////boolean lb_cambio = true
////string ls_mensaje = ''
////
if isnull(dw_maestro.getitemstring(row,'codcli')) or dw_maestro.getitemstring(row,'codcli')="" then
	MessageBox('Alerta','No se ha elegido el Cliente')
	return false
end if
return true
end event

event dw_maestro::buttonclicked;call super::buttonclicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

choose case dwo.name
	case 'cb_completo'
		dw_maestro.setitem(1,'idestado','01')
		messagebox('Aviso','Se enviara para Aprobacion')
		dw_maestro.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_1.dw_2.Object.DataWindow.ReadOnly="Yes"
   	td.tp1.tab_1.tabpage_1.dw_2.insertar = false
   	td.tp1.tab_1.tabpage_1.dw_2.borrar = false
		td.tp1.tab_1.tabpage_1.cb_1.enabled = false
		td.tp1.tab_1.tabpage_1.cb_5.enabled = false
		td.tp1.tab_1.tabpage_1.cb_29.enabled = false
		td.tp1.tab_1.tabpage_2.dw_3.Object.DataWindow.ReadOnly="Yes"
    	td.tp1.tab_1.tabpage_2.dw_3.insertar = false
   	td.tp1.tab_1.tabpage_2.dw_3.borrar = false
		td.tp1.tab_1.tabpage_7.cb_8.enabled = false
		td.tp1.tab_1.tabpage_7.cb_15.enabled = false
		td.tp1.tab_1.tabpage_7.cb_30.enabled = false
		td.tp1.tab_1.tabpage_3.dw_4.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_3.dw_4.insertar = false
   	td.tp1.tab_1.tabpage_3.dw_4.borrar = false
		td.tp1.tab_1.tabpage_2.cb_2.enabled = false
		td.tp1.tab_1.tabpage_2.cb_16.enabled = false
		td.tp1.tab_1.tabpage_2.cb_31.enabled = false
		td.tp1.tab_1.tabpage_4.dw_5.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_4.dw_5.insertar = false
   	td.tp1.tab_1.tabpage_4.dw_5.borrar = false
		td.tp1.tab_1.tabpage_12.cb_13.enabled = false
		td.tp1.tab_1.tabpage_12.cb_17.enabled = false
		td.tp1.tab_1.tabpage_12.cb_32.enabled = false
		td.tp1.tab_1.tabpage_5.dw_6.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_5.dw_6.insertar = false
   	td.tp1.tab_1.tabpage_5.dw_6.borrar = false
		td.tp1.tab_1.tabpage_3.cb_3.enabled = false
		td.tp1.tab_1.tabpage_3.cb_18.enabled = false
		td.tp1.tab_1.tabpage_3.cb_33.enabled = false
		td.tp1.tab_1.tabpage_6.dw_7.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_6.dw_7.insertar = false
   	td.tp1.tab_1.tabpage_6.dw_7.borrar = false
		td.tp1.tab_1.tabpage_5.cb_6.enabled = false
		td.tp1.tab_1.tabpage_5.cb_19.enabled = false
		td.tp1.tab_1.tabpage_5.cb_34.enabled = false
		td.tp1.tab_1.tabpage_7.dw_8.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_7.dw_8.insertar = false
   	td.tp1.tab_1.tabpage_7.dw_8.borrar = false
		td.tp1.tab_1.tabpage_10.cb_11.enabled = false
		td.tp1.tab_1.tabpage_10.cb_20.enabled = false
		td.tp1.tab_1.tabpage_10.cb_35.enabled = false
		td.tp1.tab_1.tabpage_8.dw_9.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_8.dw_9.insertar = false
   	td.tp1.tab_1.tabpage_8.dw_9.borrar = false
		td.tp1.tab_1.tabpage_11.cb_12.enabled = false
		td.tp1.tab_1.tabpage_11.cb_21.enabled = false
		td.tp1.tab_1.tabpage_11.cb_36.enabled = false
		td.tp1.tab_1.tabpage_9.dw_10.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_9.dw_10.insertar = false
   	td.tp1.tab_1.tabpage_9.dw_10.borrar = false
		td.tp1.tab_1.tabpage_4.cb_4.enabled = false
		td.tp1.tab_1.tabpage_4.cb_22.enabled = false
		td.tp1.tab_1.tabpage_4.cb_37.enabled = false
		td.tp1.tab_1.tabpage_10.dw_11.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_10.dw_11.insertar = false
   	td.tp1.tab_1.tabpage_10.dw_11.borrar = false
		td.tp1.tab_1.tabpage_14.cb_27.enabled = false
		td.tp1.tab_1.tabpage_14.cb_28.enabled = false
		td.tp1.tab_1.tabpage_14.cb_38.enabled = false
		td.tp1.tab_1.tabpage_11.dw_12.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_11.dw_12.insertar = false
   	td.tp1.tab_1.tabpage_11.dw_12.borrar = false
		td.tp1.tab_1.tabpage_8.cb_9.enabled = false
		td.tp1.tab_1.tabpage_8.cb_23.enabled = false
		td.tp1.tab_1.tabpage_8.cb_39.enabled = false
		td.tp1.tab_1.tabpage_12.dw_13.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_12.dw_13.insertar = false
   	td.tp1.tab_1.tabpage_12.dw_13.borrar = false
		td.tp1.tab_1.tabpage_9.cb_10.enabled = false
		td.tp1.tab_1.tabpage_9.cb_24.enabled = false
		td.tp1.tab_1.tabpage_9.cb_40.enabled = false
		td.tp1.tab_1.tabpage_13.dw_14.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_13.dw_14.insertar = false
   	td.tp1.tab_1.tabpage_13.dw_14.borrar = false
		td.tp1.tab_1.tabpage_6.cb_7.enabled = false
		td.tp1.tab_1.tabpage_6.cb_25.enabled = false
		td.tp1.tab_1.tabpage_6.cb_41.enabled = false
		td.tp1.tab_1.tabpage_14.dw_15.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_14.dw_15.insertar = false
   	td.tp1.tab_1.tabpage_14.dw_15.borrar = false
		td.tp1.tab_1.tabpage_13.cb_14.enabled = false
		td.tp1.tab_1.tabpage_13.cb_26.enabled = false
		td.tp1.tab_1.tabpage_13.cb_42.enabled = false
		td.tp1.tab_1.tabpage_15.dw_17.Object.DataWindow.ReadOnly="Yes"
		td.tp1.tab_1.tabpage_15.dw_17.insertar = false
   	td.tp1.tab_1.tabpage_15.dw_17.borrar = false
		td.tp1.tab_1.tabpage_15.cb_44.enabled = false
		td.tp1.tab_1.tabpage_15.cb_45.enabled = false
	
end choose
end event

type td from w_md_std`td within w_mnt_gastotelco
integer x = 50
integer y = 832
integer width = 3077
integer height = 1304
integer taborder = 20
tp15 tp15
end type

on td.create
this.tp15=create tp15
int iCurrent
call super::create
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.tp15
end on

on td.destroy
call super::destroy
destroy(this.tp15)
end on

type tp1 from w_md_std`tp1 within td
event create ( )
event destroy ( )
integer y = 112
integer width = 3040
integer height = 1176
string text = "Gasto Telecomunicaciones"
string picturename = "FormatDollar!"
tab_1 tab_1
end type

on tp1.create
this.tab_1=create tab_1
int iCurrent
call super::create
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.tab_1
end on

on tp1.destroy
call super::destroy
destroy(this.tab_1)
end on

type dw1 from w_md_std`dw1 within tp1
boolean visible = false
integer x = 2674
integer y = 44
integer width = 357
integer height = 320
end type

type tab_1 from tab within tp1
event create ( )
event destroy ( )
integer x = 32
integer y = 20
integer width = 3003
integer height = 1092
integer taborder = 10
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 79741120
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_1 tabpage_1
tabpage_7 tabpage_7
tabpage_2 tabpage_2
tabpage_12 tabpage_12
tabpage_3 tabpage_3
tabpage_5 tabpage_5
tabpage_10 tabpage_10
tabpage_11 tabpage_11
tabpage_4 tabpage_4
tabpage_14 tabpage_14
tabpage_8 tabpage_8
tabpage_9 tabpage_9
tabpage_6 tabpage_6
tabpage_13 tabpage_13
tabpage_15 tabpage_15
end type

on tab_1.create
this.tabpage_1=create tabpage_1
this.tabpage_7=create tabpage_7
this.tabpage_2=create tabpage_2
this.tabpage_12=create tabpage_12
this.tabpage_3=create tabpage_3
this.tabpage_5=create tabpage_5
this.tabpage_10=create tabpage_10
this.tabpage_11=create tabpage_11
this.tabpage_4=create tabpage_4
this.tabpage_14=create tabpage_14
this.tabpage_8=create tabpage_8
this.tabpage_9=create tabpage_9
this.tabpage_6=create tabpage_6
this.tabpage_13=create tabpage_13
this.tabpage_15=create tabpage_15
this.Control[]={this.tabpage_1,&
this.tabpage_7,&
this.tabpage_2,&
this.tabpage_12,&
this.tabpage_3,&
this.tabpage_5,&
this.tabpage_10,&
this.tabpage_11,&
this.tabpage_4,&
this.tabpage_14,&
this.tabpage_8,&
this.tabpage_9,&
this.tabpage_6,&
this.tabpage_13,&
this.tabpage_15}
end on

on tab_1.destroy
destroy(this.tabpage_1)
destroy(this.tabpage_7)
destroy(this.tabpage_2)
destroy(this.tabpage_12)
destroy(this.tabpage_3)
destroy(this.tabpage_5)
destroy(this.tabpage_10)
destroy(this.tabpage_11)
destroy(this.tabpage_4)
destroy(this.tabpage_14)
destroy(this.tabpage_8)
destroy(this.tabpage_9)
destroy(this.tabpage_6)
destroy(this.tabpage_13)
destroy(this.tabpage_15)
end on

type tabpage_1 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "TF - Pri"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_29 cb_29
dw_2 dw_2
cb_1 cb_1
dw_1 dw_1
cb_5 cb_5
end type

on tabpage_1.create
this.cb_29=create cb_29
this.dw_2=create dw_2
this.cb_1=create cb_1
this.dw_1=create dw_1
this.cb_5=create cb_5
this.Control[]={this.cb_29,&
this.dw_2,&
this.cb_1,&
this.dw_1,&
this.cb_5}
end on

on tabpage_1.destroy
destroy(this.cb_29)
destroy(this.dw_2)
destroy(this.cb_1)
destroy(this.dw_1)
destroy(this.cb_5)
end on

type cb_29 from commandbutton within tabpage_1
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_2.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_tf_pri, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_2.InsertRow(0)
					dw_2.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_2.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_2.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_2.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_2.object.numlin[ll_fila]       = lds.object.numlin[j]
					dw_2.object.numpri[ll_fila]       = lds.object.numpris[j]
					dw_2.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_2.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_2.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_2 from uo_dw_std within tabpage_1
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 40
string dataobject = "d_lis_gasto_telco_tf_pri"
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,11)




end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
////this.setitem(al_row,'anno',ls_anno)
//
////if is_codcli<>"" then
////	this.setitem(al_row,"codcli",is_codcli)
////end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose
//
return 0


end event

event ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
dw_1.settransobject(sqlca)
dw_2.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_2.retrieve(ll_idsol,11)
dw_1.retrieve(1)
//Caso de Tipo de Sucursal

//if dw_2.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if

//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 
end if 

if isnull(ll_sede) or ll_sede <> 0 then
for li_cont = 1 to dw_1.rowcount()
	ll_op = dw_1.object.idoperador[li_cont]
	ll_prod = dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then		
         li_row = dw_2.insertrow(0)
			dw_2.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_2.object.idoperador[li_row] = dw_1.object.idoperador[li_cont]
			dw_2.object.idproductomkt[li_row] = dw_1.object.idproductomkt[li_cont]
			dw_2.object.idsede[li_row] = ll_sede
		else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_1 from commandbutton within tabpage_1
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_2.trigger event ue_insertar()

end event

type dw_1 from uo_dw_std within tabpage_1
boolean visible = false
integer x = 1280
integer y = 308
integer width = 1568
integer height = 476
integer taborder = 20
boolean bringtotop = true
string dataobject = "d_lis_formatos"
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;return retrieve(is_codcli)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;int ls_anno
select to_char(sysdate,'yyyy') 
into :ls_anno
from dual; 
this.setitem(al_row,'anno',ls_anno)

if is_codcli<>"" then
	this.setitem(al_row,"codcli",is_codcli)
end if
end event

type cb_5 from commandbutton within tabpage_1
integer x = 366
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_2.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_2.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')



end event

type tabpage_7 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "TF - Analogica"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_30 cb_30
dw_8 dw_8
cb_8 cb_8
cb_15 cb_15
end type

on tabpage_7.create
this.cb_30=create cb_30
this.dw_8=create dw_8
this.cb_8=create cb_8
this.cb_15=create cb_15
this.Control[]={this.cb_30,&
this.dw_8,&
this.cb_8,&
this.cb_15}
end on

on tabpage_7.destroy
destroy(this.cb_30)
destroy(this.dw_8)
destroy(this.cb_8)
destroy(this.cb_15)
end on

type cb_30 from commandbutton within tabpage_7
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_8.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_tf_analogica, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_8.InsertRow(0)
					dw_8.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_8.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_8.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_8.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_8.object.numlin[ll_fila]      = lds.object.numlin[j]
					dw_8.object.fecfin[ll_fila]      = lds.object.fechafin[j]
					dw_8.object.idprvsrv[ll_fila]    = lds.object.idprvsrv[j]
					dw_8.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_8 from uo_dw_std within tabpage_7
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_tf_analogica"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown


end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,12)








end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_op, ll_prod, ll_count
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_8.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_8.retrieve(ll_idsol,12)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(7)

//Caso de Tipo de Sucursal
//if dw_8.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_8.insertrow(0)
			dw_8.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_8.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_8.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_8.object.idsede[li_row] = ll_sede
     else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if 
next
end if
end event

type cb_8 from commandbutton within tabpage_7
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_8.trigger event ue_insertar()

end event

type cb_15 from commandbutton within tabpage_7
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_8.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_8.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_2 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "LDN"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_31 cb_31
dw_3 dw_3
cb_2 cb_2
cb_16 cb_16
end type

on tabpage_2.create
this.cb_31=create cb_31
this.dw_3=create dw_3
this.cb_2=create cb_2
this.cb_16=create cb_16
this.Control[]={this.cb_31,&
this.dw_3,&
this.cb_2,&
this.cb_16}
end on

on tabpage_2.destroy
destroy(this.cb_31)
destroy(this.dw_3)
destroy(this.cb_2)
destroy(this.cb_16)
end on

type cb_31 from commandbutton within tabpage_2
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_3.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_ldn, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_3.InsertRow(0)
					dw_3.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_3.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_3.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_3.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_3.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_3.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_3.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_3 from uo_dw_std within tabpage_2
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_ldn"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,3)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_3.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_3.retrieve(ll_idsol,3)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(2)

//Caso de Tipo de Sucursal
//if dw_3.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_3.insertrow(0)
			dw_3.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_3.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_3.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_3.object.idsede[li_row] = ll_sede
     else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_2 from commandbutton within tabpage_2
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_3.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_3.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_3.retrieve(ll_idsol,3)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(2)
//
////Caso de Tipo de Sucursal
////if dw_3.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_3.insertrow(0)
//			dw_3.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_3.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_3.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_3.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type cb_16 from commandbutton within tabpage_2
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_3.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_3.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_12 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "LDI"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_32 cb_32
cb_13 cb_13
dw_13 dw_13
cb_17 cb_17
end type

on tabpage_12.create
this.cb_32=create cb_32
this.cb_13=create cb_13
this.dw_13=create dw_13
this.cb_17=create cb_17
this.Control[]={this.cb_32,&
this.cb_13,&
this.dw_13,&
this.cb_17}
end on

on tabpage_12.destroy
destroy(this.cb_32)
destroy(this.cb_13)
destroy(this.dw_13)
destroy(this.cb_17)
end on

type cb_32 from commandbutton within tabpage_12
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_13.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_ldi, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_13.InsertRow(0)
					dw_13.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_13.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_13.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_13.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_13.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_13.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_13.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_13 from commandbutton within tabpage_12
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_13.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_13.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_13.retrieve(ll_idsol,4)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(12)
//
////Caso de Tipo de Sucursal
////if dw_13.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_13.insertrow(0)
//			dw_13.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_13.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_13.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_13.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type dw_13 from uo_dw_std within tabpage_12
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_ldi"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,4)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_13.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_13.retrieve(ll_idsol,4)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(12)

//Caso de Tipo de Sucursal
//if dw_13.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_13.insertrow(0)
			dw_13.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_13.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_13.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_13.object.idsede[li_row] = ll_sede
  	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_17 from commandbutton within tabpage_12
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_13.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_13.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_3 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Internet"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_33 cb_33
dw_4 dw_4
cb_3 cb_3
cb_18 cb_18
end type

on tabpage_3.create
this.cb_33=create cb_33
this.dw_4=create dw_4
this.cb_3=create cb_3
this.cb_18=create cb_18
this.Control[]={this.cb_33,&
this.dw_4,&
this.cb_3,&
this.cb_18}
end on

on tabpage_3.destroy
destroy(this.cb_33)
destroy(this.dw_4)
destroy(this.cb_3)
destroy(this.cb_18)
end on

type cb_33 from commandbutton within tabpage_3
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_4.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_internet, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_4.InsertRow(0)
					dw_4.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_4.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_4.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_4.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_4.object.numpuerta[ll_fila]       = lds.object.numpuertas[j]
					dw_4.object.banwid[ll_fila]       = lds.object.banwid[j]
					dw_4.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_4.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_4.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_4 from uo_dw_std within tabpage_3
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_internet"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,1)






end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_4.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_4.retrieve(ll_idsol,1)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(3)

//Caso de Tipo de Sucursal
//if dw_4.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_4.insertrow(0)
			dw_4.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_4.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_4.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_4.object.idsede[li_row] = ll_sede
 	 else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_3 from commandbutton within tabpage_3
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_4.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_4.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_4.retrieve(ll_idsol,1)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(3)
//
////Caso de Tipo de Sucursal
////if dw_4.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_4.insertrow(0)
//			dw_4.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_4.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_4.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_4.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type cb_18 from commandbutton within tabpage_3
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_4.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_4.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_5 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Datos - Local"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_34 cb_34
dw_6 dw_6
cb_6 cb_6
cb_19 cb_19
end type

on tabpage_5.create
this.cb_34=create cb_34
this.dw_6=create dw_6
this.cb_6=create cb_6
this.cb_19=create cb_19
this.Control[]={this.cb_34,&
this.dw_6,&
this.cb_6,&
this.cb_19}
end on

on tabpage_5.destroy
destroy(this.cb_34)
destroy(this.dw_6)
destroy(this.cb_6)
destroy(this.cb_19)
end on

type cb_34 from commandbutton within tabpage_5
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_6.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_datos_local, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_6.InsertRow(0)
					dw_6.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_6.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_6.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_6.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_6.object.numpuerta[ll_fila]       = lds.object.numpuertas[j]
					dw_6.object.banwid[ll_fila]       = lds.object.banwid[j]
					dw_6.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_6.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_6.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_6 from uo_dw_std within tabpage_5
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_datos_local"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,14)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_6.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_6.retrieve(ll_idsol,14)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(5)

//Caso de Tipo de Sucursal
//if dw_6.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_6.insertrow(0)
			dw_6.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_6.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_6.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_6.object.idsede[li_row] = ll_sede
	 else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_6 from commandbutton within tabpage_5
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_6.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_6.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_6.retrieve(ll_idsol,14)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(5)
//
////Caso de Tipo de Sucursal
////if dw_6.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_6.insertrow(0)
//			dw_6.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_6.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_6.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_6.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type cb_19 from commandbutton within tabpage_5
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_6.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_6.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_10 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Datos - Nacional"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_35 cb_35
cb_11 cb_11
dw_11 dw_11
cb_20 cb_20
end type

on tabpage_10.create
this.cb_35=create cb_35
this.cb_11=create cb_11
this.dw_11=create dw_11
this.cb_20=create cb_20
this.Control[]={this.cb_35,&
this.cb_11,&
this.dw_11,&
this.cb_20}
end on

on tabpage_10.destroy
destroy(this.cb_35)
destroy(this.cb_11)
destroy(this.dw_11)
destroy(this.cb_20)
end on

type cb_35 from commandbutton within tabpage_10
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_11.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_datos_nacional, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_11.InsertRow(0)
					dw_11.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_11.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_11.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_11.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_11.object.numpuerta[ll_fila]       = lds.object.numpuertas[j]
					dw_11.object.banwid[ll_fila]       = lds.object.banwid[j]
					dw_11.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_11.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_11.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_11 from commandbutton within tabpage_10
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_11.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_11.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_11.retrieve(ll_idsol,17)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(11)
//
////Caso de Tipo de Sucursal
////if dw_11.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_11.insertrow(0)
//			dw_11.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_11.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_11.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_11.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type dw_11 from uo_dw_std within tabpage_10
integer x = 23
integer y = 104
integer width = 2697
integer height = 504
integer taborder = 50
string dataobject = "d_lis_gasto_telco_datos_nacional"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,17)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose
//
return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_11.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_11.retrieve(ll_idsol,17)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(11)

//Caso de Tipo de Sucursal
//if dw_11.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_11.insertrow(0)
			dw_11.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_11.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_11.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_11.object.idsede[li_row] = ll_sede
	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_20 from commandbutton within tabpage_10
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_11.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_11.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_11 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Datos - Internacional"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_36 cb_36
dw_12 dw_12
cb_12 cb_12
cb_21 cb_21
end type

on tabpage_11.create
this.cb_36=create cb_36
this.dw_12=create dw_12
this.cb_12=create cb_12
this.cb_21=create cb_21
this.Control[]={this.cb_36,&
this.dw_12,&
this.cb_12,&
this.cb_21}
end on

on tabpage_11.destroy
destroy(this.cb_36)
destroy(this.dw_12)
destroy(this.cb_12)
destroy(this.cb_21)
end on

type cb_36 from commandbutton within tabpage_11
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_12.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_datos_inter, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_12.InsertRow(0)
					dw_12.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_12.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_12.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_12.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_12.object.numpuerta[ll_fila]       = lds.object.numpuertas[j]
					dw_12.object.banwid[ll_fila]       = lds.object.banwid[j]
					dw_12.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_12.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_12.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_12 from uo_dw_std within tabpage_11
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
boolean bringtotop = true
string dataobject = "d_lis_gasto_telco_datos_inter"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,16)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_12.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_12.retrieve(ll_idsol,16)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(10)

//Caso de Tipo de Sucursal
//if dw_12.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_12.insertrow(0)
			dw_12.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_12.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_12.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_12.object.idsede[li_row] = ll_sede
	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
     end if
next
end if
end event

type cb_12 from commandbutton within tabpage_11
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_12.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_12.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_12.retrieve(ll_idsol,16)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(10)
//
////Caso de Tipo de Sucursal
////if dw_12.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_12.insertrow(0)
//			dw_12.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_12.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_12.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_12.object.idsede[li_row] = ll_sede
//     end if
//next
//end if
end event

type cb_21 from commandbutton within tabpage_11
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_12.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_12.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_4 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "0-800 Local"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_37 cb_37
dw_5 dw_5
cb_4 cb_4
cb_22 cb_22
end type

on tabpage_4.create
this.cb_37=create cb_37
this.dw_5=create dw_5
this.cb_4=create cb_4
this.cb_22=create cb_22
this.Control[]={this.cb_37,&
this.dw_5,&
this.cb_4,&
this.cb_22}
end on

on tabpage_4.destroy
destroy(this.cb_37)
destroy(this.dw_5)
destroy(this.cb_4)
destroy(this.cb_22)
end on

type cb_37 from commandbutton within tabpage_4
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_5.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_0800_local, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_5.InsertRow(0)
					dw_5.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_5.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_5.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_5.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_5.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_5.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_5.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_5 from uo_dw_std within tabpage_4
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_0800_local"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,13)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_5.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_5.retrieve(ll_idsol,13)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(4)

//Caso de Tipo de Sucursal
//if dw_5.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_5.insertrow(0)
			dw_5.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_5.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_5.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_5.object.idsede[li_row] = ll_sede
     else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if
next
end if
end event

type cb_4 from commandbutton within tabpage_4
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_5.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_5.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_5.retrieve(ll_idsol,13)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(4)
//
////Caso de Tipo de Sucursal
////if dw_5.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_5.insertrow(0)
//			dw_5.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_5.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_5.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_5.object.idsede[li_row] = ll_sede
//	  end if
//next
//end if
end event

type cb_22 from commandbutton within tabpage_4
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_5.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_5.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_14 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "0-800 Nacional"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_38 cb_38
cb_27 cb_27
cb_28 cb_28
dw_15 dw_15
end type

on tabpage_14.create
this.cb_38=create cb_38
this.cb_27=create cb_27
this.cb_28=create cb_28
this.dw_15=create dw_15
this.Control[]={this.cb_38,&
this.cb_27,&
this.cb_28,&
this.dw_15}
end on

on tabpage_14.destroy
destroy(this.cb_38)
destroy(this.cb_27)
destroy(this.cb_28)
destroy(this.dw_15)
end on

type cb_38 from commandbutton within tabpage_14
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_15.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_0800_nacional, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_15.InsertRow(0)
					dw_15.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_15.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_15.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_15.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_15.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_15.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_15.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_27 from commandbutton within tabpage_14
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_15.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_15.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_15.retrieve(ll_idsol,18)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(14)
//
////Caso de Tipo de Sucursal
////if dw_15.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_15.insertrow(0)
//			dw_15.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_15.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_15.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_15.object.idsede[li_row] = ll_sede
//     end if
//next
//end if
end event

type cb_28 from commandbutton within tabpage_14
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_15.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_15.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type dw_15 from uo_dw_std within tabpage_14
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_0800_nacional"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,18)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_15.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_15.retrieve(ll_idsol,18)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(14)

//Caso de Tipo de Sucursal
//if dw_15.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_15.insertrow(0)
			dw_15.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_15.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_15.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_15.object.idsede[li_row] = ll_sede
 	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
     end if
next
end if
end event

type tabpage_8 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "ADSL"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_39 cb_39
cb_9 cb_9
dw_9 dw_9
cb_23 cb_23
end type

on tabpage_8.create
this.cb_39=create cb_39
this.cb_9=create cb_9
this.dw_9=create dw_9
this.cb_23=create cb_23
this.Control[]={this.cb_39,&
this.cb_9,&
this.dw_9,&
this.cb_23}
end on

on tabpage_8.destroy
destroy(this.cb_39)
destroy(this.cb_9)
destroy(this.dw_9)
destroy(this.cb_23)
end on

type cb_39 from commandbutton within tabpage_8
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_9.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_adsl, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_9.InsertRow(0)
					dw_9.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_9.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_9.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_9.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_9.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_9.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_9.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_9 from commandbutton within tabpage_8
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_9.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_9.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_9.retrieve(ll_idsol,15)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(9)
//
////Caso de Tipo de Sucursal
////if dw_9.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_9.insertrow(0)
//			dw_9.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_9.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_9.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_9.object.idsede[li_row] = ll_sede
//  	  end if 
//next
//end if
end event

type dw_9 from uo_dw_std within tabpage_8
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_adsl"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,15)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_9.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_9.retrieve(ll_idsol,15)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(9)

//Caso de Tipo de Sucursal
//if dw_9.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_9.insertrow(0)
			dw_9.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_9.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_9.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_9.object.idsede[li_row] = ll_sede
	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
  	  end if 
next
end if
end event

type cb_23 from commandbutton within tabpage_8
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_9.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_9.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_9 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Dial Up"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_40 cb_40
cb_10 cb_10
dw_10 dw_10
cb_24 cb_24
end type

on tabpage_9.create
this.cb_40=create cb_40
this.cb_10=create cb_10
this.dw_10=create dw_10
this.cb_24=create cb_24
this.Control[]={this.cb_40,&
this.cb_10,&
this.dw_10,&
this.cb_24}
end on

on tabpage_9.destroy
destroy(this.cb_40)
destroy(this.cb_10)
destroy(this.dw_10)
destroy(this.cb_24)
end on

type cb_40 from commandbutton within tabpage_9
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_10.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_dialup, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_10.InsertRow(0)
					dw_10.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_10.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_10.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_10.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_10.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_10.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_10.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_10 from commandbutton within tabpage_9
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_10.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_10.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_10.retrieve(ll_idsol,9)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(8)
//
////Caso de Tipo de Sucursal
////if dw_10.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_10.insertrow(0)
//			dw_10.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_10.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_10.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_10.object.idsede[li_row] = ll_sede
//	  end if 
//next
//end if
end event

type dw_10 from uo_dw_std within tabpage_9
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_dial_up"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,9)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_10.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_10.retrieve(ll_idsol,9)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(8)

//Caso de Tipo de Sucursal
//if dw_10.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_10.insertrow(0)
			dw_10.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_10.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_10.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_10.object.idsede[li_row] = ll_sede
	 else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if 
next
end if
end event

type cb_24 from commandbutton within tabpage_9
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_10.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_10.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_6 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Hosting"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_41 cb_41
dw_7 dw_7
cb_7 cb_7
cb_25 cb_25
end type

on tabpage_6.create
this.cb_41=create cb_41
this.dw_7=create dw_7
this.cb_7=create cb_7
this.cb_25=create cb_25
this.Control[]={this.cb_41,&
this.dw_7,&
this.cb_7,&
this.cb_25}
end on

on tabpage_6.destroy
destroy(this.cb_41)
destroy(this.dw_7)
destroy(this.cb_7)
destroy(this.cb_25)
end on

type cb_41 from commandbutton within tabpage_6
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_7.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_hosting, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_7.InsertRow(0)
					dw_7.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_7.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_7.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_7.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_7.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_7.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_7.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type dw_7 from uo_dw_std within tabpage_6
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_hosting"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,19)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_7.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_7.retrieve(ll_idsol,19)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(6)

//Caso de Tipo de Sucursal
//if dw_7.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_7.insertrow(0)
			dw_7.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_7.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_7.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_7.object.idsede[li_row] = ll_sede
	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
     end if
next
end if
end event

type cb_7 from commandbutton within tabpage_6
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_7.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_7.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_7.retrieve(ll_idsol,19)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(6)
//
////Caso de Tipo de Sucursal
////if dw_7.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_7.insertrow(0)
//			dw_7.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_7.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_7.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_7.object.idsede[li_row] = ll_sede
//     end if
//next
//end if
end event

type cb_25 from commandbutton within tabpage_6
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_7.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_7.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_13 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Colocation"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
cb_42 cb_42
cb_14 cb_14
dw_14 dw_14
cb_26 cb_26
end type

on tabpage_13.create
this.cb_42=create cb_42
this.cb_14=create cb_14
this.dw_14=create dw_14
this.cb_26=create cb_26
this.Control[]={this.cb_42,&
this.cb_14,&
this.dw_14,&
this.cb_26}
end on

on tabpage_13.destroy
destroy(this.cb_42)
destroy(this.cb_14)
destroy(this.dw_14)
destroy(this.cb_26)
end on

type cb_42 from commandbutton within tabpage_13
integer x = 709
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_14.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_colocation, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_14.InsertRow(0)
					dw_14.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_14.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_14.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_14.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_14.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_14.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_14.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type cb_14 from commandbutton within tabpage_13
integer x = 23
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_14.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_14.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_14.retrieve(ll_idsol,20)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(13)
//
////Caso de Tipo de Sucursal
////if dw_14.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_14.insertrow(0)
//			dw_14.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_14.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_14.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_14.object.idsede[li_row] = ll_sede
//	  end if 
//next
//end if
end event

type dw_14 from uo_dw_std within tabpage_13
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 50
string dataobject = "d_lis_gasto_telco_colocation"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,20)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//dwobject dwo_data
//
//st_par lst_par_in , lst_par_out
//long ll_row 
//long ln_idproducto, ln_null, ln_idrango
//
//SetNull(ln_null)
//
//ll_row = dw_maestro.getrow()
//choose case as_columna
//	case 'dsclineas'
//			lst_par_out.valido = false
//			openwithparm(w_bus_lineas, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numlin[al_row]    	  = lst_par_out.parlong1
//            object.dsclineas[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//
//  case 'dscpris'
//			lst_par_out.valido = false
//			openwithparm(w_bus_pris, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.numpris[al_row]    	  = lst_par_out.parlong1
//            object.dscpris[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//		
//end choose

return 0
end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in
st_par lst_par_out
string ls_codcli
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_14.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_14.retrieve(ll_idsol,20)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(13)

//Caso de Tipo de Sucursal
//if dw_14.rowcount() > 0 then
   lst_par_in.valido = false
	openwithparm(w_bus_sede, lst_par_in)
	lst_par_out = message.PowerObjectParm
	If lst_par_out.valido then
		ll_sede = lst_par_out.parlong1
	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_14.insertrow(0)
			dw_14.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_14.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_14.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
			dw_14.object.idsede[li_row] = ll_sede
	  else
			MessageBox('Mensaje','Ya existe data, para actualizar')
	  end if 
next
end if
end event

type cb_26 from commandbutton within tabpage_13
integer x = 366
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_14.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_14.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type tabpage_15 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 2967
integer height = 972
long backcolor = 79741120
string text = "Telefonia Publica"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
long picturemaskcolor = 536870912
dw_17 dw_17
cb_45 cb_45
cb_44 cb_44
cb_46 cb_46
end type

on tabpage_15.create
this.dw_17=create dw_17
this.cb_45=create cb_45
this.cb_44=create cb_44
this.cb_46=create cb_46
this.Control[]={this.dw_17,&
this.cb_45,&
this.cb_44,&
this.cb_46}
end on

on tabpage_15.destroy
destroy(this.dw_17)
destroy(this.cb_45)
destroy(this.cb_44)
destroy(this.cb_46)
end on

type dw_17 from uo_dw_std within tabpage_15
integer x = 23
integer y = 104
integer width = 2697
integer height = 588
integer taborder = 60
string dataobject = "d_lis_gasto_telco_telefonia_publica"
boolean hsplitscroll = false
boolean livescroll = false
boolean seleccionar = false
end type

event rbuttondown;if il_idsol = 0 then 
	return
end if

// se llama al padre
CALL SUPER::rbuttondown
end event

event ue_retrieve;long ll_idsol
if dw_maestro.getrow() < 1 then return 0
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
return retrieve(ll_idsol,21)







end event

event ue_update_post;call super::ue_update_post;triggerevent('ue_retrieve')
return true


end event

event ue_valores_iniciales;call super::ue_valores_iniciales;//int ls_anno
//select to_char(sysdate,'yyyy') 
//into :ls_anno
//from dual; 
//this.setitem(al_row,'anno',ls_anno)
//
//if is_codcli<>"" then
//	this.setitem(al_row,"codcli",is_codcli)
//end if
end event

event ue_valida_dato;call super::ue_valida_dato;//st_par lst_par_in , lst_par, lst_par_out
//
//AcceptText()
//choose case as_columna
//	  case 'cndcontrato'
//			lst_par_out.valido = false
//			openwithparm(w_bus_cnd_contrato, lst_par_in)
//			lst_par_out = message.PowerObjectParm
//			If lst_par_out.valido then
//				object.cndcontrato[al_row]    = lst_par_out.parlong1
//            object.descripcion[al_row]    = lst_par_out.parstring1
//				this.AcceptText()
//		   end if
//end choose
//return 1
return 0


end event

event ue_insertar;call super::ue_insertar;st_par lst_par_in, lst_par
st_par lst_par_out
string ls_codcli, ls_codsuc, ls_nomsuc, ls_dirsuc
integer li_row
integer li_cont
long ll_sede, ll_idsol, ll_count, ll_op, ll_prod, ll_codsuc
td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
dw_17.settransobject(sqlca)
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
dw_17.retrieve(ll_idsol,21)
td.tp1.tab_1.tabpage_1.dw_1.retrieve(15)

//Caso de Tipo de Sucursal
//if dw_17.rowcount() > 0 then
	  if Not IsNull(is_codcli) then
			lst_par_in.parstring1 = dw_maestro.object.codcli[dw_maestro.getrow()]
			lst_par_in.parstring2 = dw_maestro.object.nomcli[dw_maestro.getrow()]
			OpenWithParm(w_buscar_sucursales,lst_par_in)
			lst_par = message.PowerObjectParm
			If lst_par.valido then
				ls_codsuc = lst_par.parstring4
				ls_nomsuc = lst_par.parstring5
				ls_dirsuc = lst_par.parstring6
			end if
			AcceptText()
		end if 
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
//else
//	ll_sede = 1//valor de lima
//end if
//Fin Caso de Sucursal
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
end if 

//if isnull(ll_sede) or ll_sede <> 0 then 
for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
	select count(*) into :ll_count
	from proveedor_servicio
	where idoperador = :ll_op and
	      idproductomkt = :ll_prod and
		   idsede = :ll_sede and
			codcli = :ls_codcli;
	  if ll_count = 0  then
			li_row = dw_17.insertrow(0)
			dw_17.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
			dw_17.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
			dw_17.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
    		dw_17.object.codsuc[li_row] = ls_codsuc
			dw_17.object.nomsuc[li_row] = ls_nomsuc
			dw_17.object.dirsuc[li_row] = ls_dirsuc
	  end if 
next
//end if
end event

type cb_45 from commandbutton within tabpage_15
integer x = 366
integer width = 343
integer height = 100
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Grabar"
end type

event clicked;long ll_idsol
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
if isnull(ll_idsol) then
	messagebox('Alerta','No se ha generado Codigo de Solicitud')
	return 0
end if

//dw_14.update()
//commit;
//messagebox("Aviso",'Se Grabaron los Datos')
dw_17.triggerevent("ue_guardar")
messagebox("Aviso",'Se Grabaron los Datos')
end event

type cb_44 from commandbutton within tabpage_15
integer x = 23
integer width = 343
integer height = 100
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Insertar"
end type

event clicked;dw_17.trigger event ue_insertar()
//st_par lst_par_in
//st_par lst_par_out
//string ls_codcli
//integer li_row
//integer li_cont
//long ll_sede, ll_idsol, ll_count, ll_op, ll_prod
//td.tp1.tab_1.tabpage_1.dw_1.settransobject(sqlca)
//dw_17.settransobject(sqlca)
//ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
//ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
//dw_17.retrieve(ll_idsol,21)
//td.tp1.tab_1.tabpage_1.dw_1.retrieve(15)
//
////Caso de Tipo de Sucursal
////if dw_17.rowcount() > 0 then
//   lst_par_in.valido = false
//	openwithparm(w_bus_sede, lst_par_in)
//	lst_par_out = message.PowerObjectParm
//	If lst_par_out.valido then
//		ll_sede = lst_par_out.parlong1
//	end if
////else
////	ll_sede = 1//valor de lima
////end if
////Fin Caso de Sucursal
//if isnull(ll_idsol) then
//	messagebox('Alerta','No se ha generado Codigo de Solicitud')
//	return 0
//end if 
//
//if isnull(ll_sede) or ll_sede <> 0 then 
//for li_cont = 1 to td.tp1.tab_1.tabpage_1.dw_1.rowcount()
//	ll_op = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//	ll_prod = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//	select count(*) into :ll_count
//	from proveedor_servicio
//	where idoperador = :ll_op and
//	      idproductomkt = :ll_prod and
//		   idsede = :ll_sede and
//			codcli = :ls_codcli;
//	  if ll_count = 0  then
//			li_row = dw_17.insertrow(0)
//			dw_17.object.idsol[li_row] = dw_maestro.object.idsol[dw_maestro.getrow()]
//			dw_17.object.idoperador[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idoperador[li_cont]
//			dw_17.object.idproductomkt[li_row] = td.tp1.tab_1.tabpage_1.dw_1.object.idproductomkt[li_cont]
//			dw_17.object.idsede[li_row] = ll_sede
//	  end if 
//next
//end if
end event

type cb_46 from commandbutton within tabpage_15
boolean visible = false
integer x = 709
integer width = 343
integer height = 100
integer taborder = 40
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Actualizacion"
end type

event clicked;st_par lst_par_in, lst_par
st_par lst_par_out
long  ll_sede, ll_cantidad, j, ll_fila, ll_idsol
string ls_codcli
datastore lds 
ll_idsol = dw_maestro.object.idsol[dw_maestro.getrow()]
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
lst_par_in.parstring1 = ls_codcli
dw_17.settransobject(sqlca)
lst_par_in.valido = false
Openwithparm(w_bus_proveedor_servicio_colocation, lst_par_in)
		lst_par = message.PowerObjectParm
		if lst_par.valido then
			lds = create datastore
			lds.DataObject = 'dw_retorno_proveedor_servicio'
			lds.SetTransObject(SQLCA)
			lds = lst_par.pards1
			ll_cantidad = lds.RowCount()
			if ll_cantidad < 1 then return
			for j = 1 to ll_cantidad
					ll_fila = dw_17.InsertRow(0)
					dw_17.object.idsede[ll_fila]  	 = lds.object.idsede[j]
					dw_17.object.idproductomkt[ll_fila]   = lds.object.idproductomkt[j]
               dw_17.object.idoperador[ll_fila]      = lds.object.idoperador[j]
					dw_17.object.cr[ll_fila]       = lds.object.cr_moneda_ext[j]
					dw_17.object.fecfin[ll_fila]       = lds.object.fechafin[j]
					dw_17.object.idprvsrv[ll_fila]       = lds.object.idprvsrv[j]
					dw_17.object.idsol[ll_fila]       = ll_idsol
	      next
		end if
	

end event

type tp15 from userobject within td
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 3040
integer height = 1176
long backcolor = 79741120
string text = "Facturacion Telmex"
long tabtextcolor = 33554432
long tabbackcolor = 79741120
string picturename = "Custom048!"
long picturemaskcolor = 536870912
dw_16 dw_16
ddlb_1 ddlb_1
ddlb_2 ddlb_2
cb_43 cb_43
end type

on tp15.create
this.dw_16=create dw_16
this.ddlb_1=create ddlb_1
this.ddlb_2=create ddlb_2
this.cb_43=create cb_43
this.Control[]={this.dw_16,&
this.ddlb_1,&
this.ddlb_2,&
this.cb_43}
end on

on tp15.destroy
destroy(this.dw_16)
destroy(this.ddlb_1)
destroy(this.ddlb_2)
destroy(this.cb_43)
end on

type dw_16 from uo_dw_std within tp15
integer x = 9
integer y = 144
integer width = 2903
integer height = 940
integer taborder = 30
string dataobject = "d_lis_facturacion_telmex"
boolean seleccionar = false
end type

event rbuttondown;//if il_idficha = 0 then 
//	return
//end if
//
//// se llama al padre
//CALL SUPER::rbuttondown


	

end event

event ue_retrieve;string ls_codcli
integer li_anno
ls_codcli = dw_maestro.object.codcli[dw_maestro.getrow()]
ddlb_2.sorted = false
li_anno = integer(ddlb_1.text(ddlb_1.selectitem(ii_anno)))
dw_16.settransobject(sqlca)
dw_16.retrieve(ls_codcli,li_anno,ii_mes)
return 0
end event

type ddlb_1 from dropdownlistbox within tp15
integer x = 14
integer y = 32
integer width = 411
integer height = 352
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean sorted = false
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;ii_anno = index

end event

type ddlb_2 from dropdownlistbox within tp15
integer x = 439
integer y = 32
integer width = 411
integer height = 352
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean sorted = false
string item[] = {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;ii_mes = index
end event

type cb_43 from commandbutton within tp15
integer x = 878
integer y = 24
integer width = 343
integer height = 100
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Aceptar"
end type

event clicked;dw_16.triggerevent('ue_retrieve')

end event

